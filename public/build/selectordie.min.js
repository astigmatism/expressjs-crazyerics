!function(e){e.fn.selectOrDie=function(k){var z,m,B={customID:null,customClass:"",placeholder:null,placeholderOption:!1,prefix:null,cycle:!1,stripEmpty:!1,links:!1,linksExternal:!1,size:0,tabIndex:0,onChange:e.noop},h={},n=!1,f={initSoD:function(a){return h=e.extend({},B,a),this.each(function(){if(e(this).parent().hasClass("sod_select"))console.log("Select or Die: It looks like the SoD already exists");else{var a,b,g,c=e(this);b=c.data("custom-id")?c.data("custom-id"):h.customID;var C=c.data("custom-class")?
c.data("custom-class"):h.customClass,u=c.data("prefix")?c.data("prefix"):h.prefix,t=c.data("placeholder")?c.data("placeholder"):h.placeholder,q=c.data("placeholder-option")?c.data("placeholder-option"):h.placeholderOption,l=c.data("cycle")?c.data("cycle"):h.cycle,k=c.data("links")?c.data("links"):h.links,n=c.data("links-external")?c.data("links-external"):h.linksExternal,m=parseInt(c.data("size"))?c.data("size"):h.size,v=parseInt(c.data("tabindex"))?c.data("tabindex"):h.tabIndex?h.tabIndex:c.attr("tabindex")?
c.attr("tabindex"):h.tabIndex,p=c.data("strip-empty")?c.data("strip-empty"):h.stripEmpty,w=c.prop("title")?c.prop("title"):null,x=c.is(":disabled")?" disabled":"",r="",y=0;u&&(r='<span class="sod_prefix">'+u+"</span> ");a=e("<span/>",{id:b,"class":"sod_select "+C+x,title:w,tabindex:v,html:""+(t&&!u?'<span class="sod_label sod_placeholder">'+t+"</span>":'<span class="sod_label">'+r+"</span>"),"data-cycle":l,"data-links":k,"data-links-external":n,"data-placeholder":t,"data-placeholder-option":q,"data-prefix":u,
"data-filter":""}).insertAfter(this);f.isTouch()&&a.addClass("touch");b=e("<span/>",{"class":"sod_list_wrapper"}).appendTo(a);g=e("<span/>",{"class":"sod_list"}).appendTo(b);e("option, optgroup",c).each(function(c){var b=e(this);p&&!e.trim(b.text())?b.remove():0===c&&q&&!r?f.populateSoD(b,g,a,!0):f.populateSoD(b,g,a,!1)});m&&(b.show(),e(".sod_option:lt("+m+")",g).each(function(){y+=e(this).outerHeight()}),b.removeAttr("style"),g.css({"max-height":y}));c.appendTo(a);a.on("focusin",f.focusSod).on("click",
f.triggerSod).on("click",".sod_option",f.optionClick).on("mousemove",".sod_option",f.optionHover).on("keydown",f.keyboardUse);c.on("change",f.selectChange);e(document).on("click","label[for='"+c.attr("id")+"']",function(b){b.preventDefault();a.focus()})}})},populateSoD:function(a,d,b,g){var c=b.data("placeholder"),f=b.data("placeholder-option"),h=b.data("prefix"),t=b.find(".sod_label"),q=a.parent(),l=a.text(),k=a.val(),m=a.data("custom-id")?a.data("custom-id"):null,n=a.data("custom-class")?a.data("custom-class"):
"",v=a.is(":disabled")?" disabled ":"",p=a.is(":selected")?" selected active ":"",w=a.data("link")?" link ":"",x=a.data("link-external")?" linkexternal":"",r=a.prop("label");a.is("option")?(e("<span/>",{"class":"sod_option "+n+v+p+w+x,id:m,title:l,html:l,"data-value":k}).appendTo(d),g&&!h?(b.data("label",l),b.data("placeholder",l),a.prop("disabled",!0),d.find(".sod_option:last").addClass("is-placeholder disabled"),p&&t.addClass("sod_placeholder")):p&&c&&!f&&!h?b.data("label",c):p&&b.data("label",
l),(p&&!c||p&&f||p&&h)&&t.append(l),q.is("optgroup")&&(d.find(".sod_option:last").addClass("groupchild"),q.is(":disabled")&&d.find(".sod_option:last").addClass("disabled"))):e("<span/>",{"class":"sod_option optgroup "+v,title:r,html:r,"data-label":r}).appendTo(d)},focusSod:function(){var a=e(this);a.hasClass("disabled")?f.blurSod(a):(f.blurSod(e(".sod_select.focus").not(a)),a.addClass("focus"),e("html").on("click.sodBlur",function(){f.blurSod(a)}))},triggerSod:function(a){a.stopPropagation();a=e(this);
var d=a.find(".sod_list"),b=a.data("placeholder"),g=a.find(".active"),c=a.find(".selected");a.hasClass("disabled")||a.hasClass("open")||a.hasClass("touch")?(clearTimeout(m),a.removeClass("open"),b&&(a.find(".sod_label").get(0).lastChild.nodeValue=g.text())):(a.addClass("open"),b&&!a.data("prefix")&&a.find(".sod_label").addClass("sod_placeholder").html(b),f.listScroll(d,c),f.checkViewport(a,d))},keyboardUse:function(a){var d,b,g,c=e(this),h=c.find(".sod_list"),k=c.find(".sod_option"),m=c.find(".sod_label"),
q=c.data("cycle"),l=k.filter(".active");return 36<a.which&&41>a.which?(37===a.which||38===a.which?(b=l.prevAll(":not('.disabled, .optgroup')").first(),g=k.not(".disabled, .optgroup").last()):(39===a.which||40===a.which)&&(b=l.nextAll(":not('.disabled, .optgroup')").first(),g=k.not(".disabled, .optgroup").first()),!b.hasClass("sod_option")&&q&&(b=g),(b.hasClass("sod_option")||q)&&(l.removeClass("active"),b.addClass("active"),m.get(0).lastChild.nodeValue=b.text(),f.listScroll(h,b),c.hasClass("open")||
(n=!0)),!1):(13===a.which||32===a.which&&c.hasClass("open")&&(" "===c.data("filter")[0]||""===c.data("filter"))?(a.preventDefault(),l.click()):32!==a.which||c.hasClass("open")||" "!==c.data("filter")[0]&&""!==c.data("filter")?27===a.which&&f.blurSod(c):(a.preventDefault(),n=!1,c.click()),0!==a.which&&(clearTimeout(z),c.data("filter",c.data("filter")+String.fromCharCode(a.which)),d=k.filter(function(){return 0===e(this).text().toLowerCase().indexOf(c.data("filter").toLowerCase())}).not(".disabled, .optgroup").first(),
d.length&&(l.removeClass("active"),d.addClass("active"),f.listScroll(h,d),m.get(0).lastChild.nodeValue=d.text(),c.hasClass("open")||(n=!0)),z=setTimeout(function(){c.data("filter","")},500)),void 0)},optionHover:function(){var a=e(this);a.hasClass("disabled")||a.hasClass("optgroup")||a.siblings().removeClass("active").end().addClass("active")},optionClick:function(a){a.stopPropagation();a=e(this);var d=a.closest(".sod_select"),b=a.hasClass("disabled"),g=a.hasClass("optgroup"),c=d.find(".sod_option:not('.optgroup')").index(this);
d.hasClass("touch")||(b||g||(d.find(".selected, .sod_placeholder").removeClass("selected sod_placeholder"),a.addClass("selected"),d.find("select option")[c].selected=!0,d.find("select").change()),clearTimeout(m),d.removeClass("open"))},selectChange:function(){var a=e(this),d=a.find(":selected"),b=d.text(),a=a.closest(".sod_select");a.find(".sod_label").get(0).lastChild.nodeValue=b;a.data("label",b);h.onChange.call(this);!a.data("links")&&!d.data("link")||d.data("link-external")?(a.data("links-external")||
d.data("link-external"))&&window.open(d.val(),"_blank"):window.location.href=d.val()},blurSod:function(a){if(e("body").find(a).length){var d=a.data("label"),b=a.data("placeholder"),g=a.find(".active"),c=a.find(".selected"),f=!1;clearTimeout(m);n&&!g.hasClass("selected")?(g.click(),f=!0):g.hasClass("selected")||(g.removeClass("active"),c.addClass("active"));!f&&b?a.find(".sod_label").get(0).lastChild.nodeValue=c.text():f||(a.find(".sod_label").get(0).lastChild.nodeValue=d);n=!1;a.removeClass("open focus");
a.blur();e("html").off(".sodBlur")}},checkViewport:function(a,d){var b=a[0].getBoundingClientRect(),g=d.outerHeight();b.bottom+g+10>e(window).height()&&10<b.top-g?a.addClass("above"):a.removeClass("above");m=setTimeout(function(){f.checkViewport(a,d)},200)},listScroll:function(a,d){var b=a[0].getBoundingClientRect(),e=d[0].getBoundingClientRect();b.top>e.top?a.scrollTop(a.scrollTop()-b.top+e.top):b.bottom<e.bottom&&a.scrollTop(a.scrollTop()-b.bottom+e.bottom)},isTouch:function(){return"ontouchstart"in
window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints}},A={destroy:function(){return this.each(function(){var a=e(this),d=a.parent();d.hasClass("sod_select")?(a.off("change"),d.find("span").remove(),a.unwrap()):console.log("Select or Die: There's no SoD to destroy")})},update:function(){return this.each(function(){var a=e(this),d=a.parent(),b=d.find(".sod_list:first");d.hasClass("sod_select")?(b.empty(),d.find(".sod_label").get(0).lastChild.nodeValue="",a.is(":disabled")&&d.addClass("disabled"),
e("option, optgroup",a).each(function(){f.populateSoD(e(this),b,d)})):console.log("Select or Die: There's no SoD to update")})},disable:function(a){return this.each(function(){var d=e(this),b=d.parent();b.hasClass("sod_select")?"undefined"!=typeof a?(b.find(".sod_list:first .sod_option[data-value='"+a+"']").addClass("disabled"),b.find(".sod_list:first .sod_option[data-label='"+a+"']").nextUntil(":not(.groupchild)").addClass("disabled"),e("option[value='"+a+"'], optgroup[label='"+a+"']",this).prop("disabled",
!0)):b.hasClass("sod_select")&&(b.addClass("disabled"),d.prop("disabled",!0)):console.log("Select or Die: There's no SoD to disable")})},enable:function(a){return this.each(function(){var d=e(this),b=d.parent();b.hasClass("sod_select")?"undefined"!=typeof a?(b.find(".sod_list:first .sod_option[data-value='"+a+"']").removeClass("disabled"),b.find(".sod_list:first .sod_option[data-label='"+a+"']").nextUntil(":not(.groupchild)").removeClass("disabled"),e("option[value='"+a+"'], optgroup[label='"+a+"']",
this).prop("disabled",!1)):b.hasClass("sod_select")&&(b.removeClass("disabled"),d.prop("disabled",!1)):console.log("Select or Die: There's no SoD to enable")})}};return A[k]?A[k].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof k&&k?(e.error('Select or Die: Oh no! No such method "'+k+'" for the SoD instance'),void 0):f.initSoD.apply(this,arguments)}}(jQuery);